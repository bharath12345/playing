define(["dojo/_base/declare","dojox/layout/GridContainer","dijit/TitlePane","dijit/layout/ContentPane","dojo/request/xhr","dojo/_base/lang"],function(a,b,c,d,e,f){var g=a("renderConnectivity",null,{constructor:function(){jsPlumb.importDefaults({DragOptions:{cursor:"pointer",zIndex:2e3},EndpointStyles:[{fillStyle:"#225588"},{fillStyle:"#558822"}],Endpoints:[["Dot",{radius:3}],["Dot",{radius:3}]],ConnectionOverlays:[["Arrow",{location:.9,foldback:.5,width:6}],["Label",{location:.1,id:"label",cssClass:"aLabel"}]]})},create:function(a){for(var b=0;b<a.length;b++){var c=a[b].nodes[0]+h.ENDPOINT_SUFFIX,d=a[b].nodes[1]+h.ENDPOINT_SUFFIX;console.log("lhs div name = "+c+" rhs div name = "+d);var e=g.FROM+a[b].nodes[0]+g.TO+a[b].nodes[1],f=g.FROM+a[b].nodes[1]+g.TO+a[b].nodes[0];console.log("src uuid = "+e+" dst uuid = "+f);var j=jsPlumb.addEndpoint(c,g.sourceEndpoint,{uuid:e,container:i.PANE.domNode,anchor:"RightMiddle"}),k=jsPlumb.addEndpoint(d,g.targetEndpoint,{uuid:f,container:i.PANE.domNode,anchor:"LeftMiddle"});jsPlumb.connect({source:j,target:k,container:i.PANE.domNode})}}});g.FROM="FROM_",g.TO="_TO_",g.connectorPaintStyle={lineWidth:1,strokeStyle:"#deea18",joinstyle:"round",outlineColor:"#EAEDEF",outlineWidth:1},g.connectorHoverStyle={lineWidth:2,strokeStyle:"#2e2aF8"},g.sourceEndpoint={endpoint:"Dot",paintStyle:{fillStyle:"#225588",radius:3},isSource:!0,connector:["Straight",{stub:[40,60],gap:10}],connectorStyle:g.connectorPaintStyle,hoverPaintStyle:g.connectorHoverStyle,connectorHoverStyle:g.connectorHoverStyle,dragOptions:{},overlays:[["Label",{location:[.5,1.5],label:"",cssClass:"endpointSourceLabel"}]]},g.targetEndpoint={endpoint:"Dot",paintStyle:{fillStyle:"#558822",radius:3},hoverPaintStyle:g.connectorHoverStyle,maxConnections:-1,dropOptions:{hoverClass:"hover",activeClass:"active"},isTarget:!0,overlays:[["Label",{location:[.5,-.5],label:"",cssClass:"endpointTargetLabel"}]]};var h=a("renderNodes",null,{getSvgIcon:function(a,b,c){var d=dojo.create("img");return d.src=a,d.height=b,d.width=c,d},createEndpoint:function(a,b,c,d){for(var e="width: "+c+"; height: "+d+";",f=0;f<a.length;f++){var g=dojo.byId(b+h.ROW_SUFFIX),i=dojo.create("div");i.id=b+"_"+a[f]+h.ENDPOINT_SUFFIX,i.className="topoIconContainer",i.style.cssText=e,g.appendChild(i);var j=50,k=50;switch(b){case h.TYPE.WEBSERVER:var l=this.getSvgIcon("../../images/topograph/osa_server_web.svg",j,k);i.appendChild(l);break;case h.TYPE.APPSERVER:var l=this.getSvgIcon("../../images/topograph/osa_server_application.svg",j,k);i.appendChild(l);break;case h.TYPE.DATABASES:var l=this.getSvgIcon("../../images/topograph/osa_database.svg",j,k);i.appendChild(l);break;case h.TYPE.MESSAGEQ:var l=this.getSvgIcon("../../images/topograph/Messaging_Queue.svg",j,k);i.appendChild(l);break;case h.TYPE.TCPENDPOINTS:var l=this.getSvgIcon("../../images/topograph/osa_ics_drive.svg",j,k);i.appendChild(l);break;default:return console.log("unknown end point type = "+b),void 0}}},createColumnPanes:function(a,c,e){console.log("in createColumnPanes = "+a.length+" w = "+c+" h = "+e);try{for(var f="width: "+c/a.length+"; height: "+e+";",g=[],i=0;i<a.length;i++){console.log("new pane for = "+a[i]);var j=new d({splitter:!1,style:f,content:"<div id='"+a[i]+h.COLUMN_SUFFIX+"' style='width: 100%; height: 100%;'></div>",title:a[i],toggleable:!1});g[i]=j}var k=new b({nbZones:a.length,isAutoOrganized:!0,style:"width: "+c+" height:"+e},"JsPlumbAppGraph");k.disableDnd();for(var l=0,m=0,i=0;i<a.length;i++)l=i%a.length,m=parseInt(i/a.length),k.addChild(g[i],l,m);k.startup(),k.resize(),this.removeMargins(k)}catch(n){console.log("exception = "+n)}},removeMargins:function(a){for(var b=dojo.query(".dijitTitlePaneContentInner",a.domNode),c=0;c<b.length;c++)b[c].style.padding=0;for(var d=dojo.query(".dijitTitlePaneTitle",a.domNode),c=0;c<d.length;c++)d[c].style.padding=0,d[c].style.minHeight=0;for(var e=dojo.query(".dijitTitlePaneTitleFocus",a.domNode),c=0;c<e.length;c++)e[c].style.margin=0,e[c].style.padding=0},createInnerPanes:function(a,d,e,f){try{for(var g=f/a.length,i="width: "+e+"; height: "+g+";",j=[],k=0;k<a.length;k++){var l=new c({splitter:!1,style:i,content:"<div id='"+a[k]+h.ROW_SUFFIX+"' style='"+i+"'></div>",title:a[k],toggleable:!1});j[k]=l}var m=new b({nbZones:1,isAutoOrganized:!0},dojo.byId(d+h.COLUMN_SUFFIX));m.disableDnd();for(var k=0;k<a.length;k++)m.addChild(j[k],1,k);m.startup(),m.resize(),this.removeMargins(m)}catch(n){console.log("exception inner page = "+n)}return j},create:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].layertype);this.createColumnPanes(b,i.width,i.height);for(var d=i.width/b.length,g=60,h=60,c=0;c<a.length;c++){console.log("layer type = "+b[c]);var j=a[c].layer;console.log("layer length = "+j.length);for(var k=[],l=0;l<j.length;l++)console.log("layer inner name = "+j[l].name),k.push(j[l].name);this.createInnerPanes(k,b[c],d,i.height);for(var l=0;l<j.length;l++)this.createEndpoint(j[l].value,j[l].name,g,h)}var m={id:"",name:""};e("../../lib/my/topograph/json/ConnectivityALL.json",{handleAs:"json",method:"GET",query:m,headers:i.JSON_HEADER}).then(f.hitch(this,this.createConnectivity));for(var n=dojo.query(".dijitTitlePaneContentOuter",i.PANE.domNode),c=0;c<n.length;c++)n[c].style.border=0;for(var o=dojo.query(".dijitTitlePaneTextNode",i.PANE.domNode),c=0;c<o.length;c++)o[c].style.display="block",o[c].style.textAlign="center"},createConnectivity:function(a){(new g).create(a)}});h.TYPE={},h.TYPE.WEBSERVER="WebServers",h.TYPE.APPSERVER="AppServers",h.TYPE.DATABASES="Databases",h.TYPE.MESSAGEQ="MessageQueues",h.TYPE.TCPENDPOINTS="TcpEndpoints",h.COLUMN_SUFFIX="_col",h.ROW_SUFFIX="_row",h.ENDPOINT_SUFFIX="_endpoint";var i=a("jsPlumbAppGraph",null,{launch:function(a){i.PANE=a;var b=document.getElementById("JsPlumbAppGraphPane");i.width=b.clientWidth,i.height=b.clientHeight,console.log("view port width = "+i.width+" height = "+i.height),e("../../lib/my/topograph/json/Nodes.json",{handleAs:"json",method:"GET",headers:i.JSON_HEADER}).then(f.hitch(this,this.createNodeLayout))},createNodeLayout:function(a){(new h).create(a)}});return i.JSON_HEADER={"Content-Type":"application/json"},i.width=300,i.height=300,i.PANE,i});